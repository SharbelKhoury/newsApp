{% extends 'base.html.twig' %}

{% block body %}
    <h1>Edit News Entry</h1>

    {{ form_start(form) }}

    <div class="form-group">
        {{ form_label(form.title) }}
        {{ form_widget(form.title, {'attr': {'class': 'form-control'}}) }}
        {{ form_errors(form.title) }}
    </div>

    <div class="form-group">
        {{ form_label(form.content) }}
        <textarea class="form-control wysiwyg-editor" name="content">{{ form.vars.value.content }}</textarea>
    </div>

    <div class="form-group">
        <label>Media</label>
        <div class="media-upload">
            {% for media in form.vars.value.media %}
                <div class="media-item">
                    <input type="file" name="media[]" class="form-control">
                    <img src="{{ media.path }}" alt="Existing Image" class="img-thumbnail" style="max-width: 150px;">
                    <button type="button" class="btn btn-danger remove-media">Remove</button>
                </div>
            {% else %}
                <div class="media-item">
                    <input type="file" name="media[]" class="form-control">
                </div>
            {% endfor %}
        </div>
        <button type="button" class="btn btn-secondary add-more">Add More</button>
    </div>

    <button class="btn btn-primary">{{ button_label|default('Save') }}</button>

    {{ form_end(form) }}

    <script>
        // WYSIWYG Editor Init (CKEditor Example)
        ClassicEditor
            .create(document.querySelector('.wysiwyg-editor'))
            .catch(error => { console.error(error); });

        // Add more media functionality
        document.querySelector('.add-more').addEventListener('click', function() {
            const mediaUpload = document.querySelector('.media-upload');
            const mediaItem = document.createElement('div');
            mediaItem.classList.add('media-item');
            mediaItem.innerHTML = '<input type="file" name="media[]" class="form-control">';
            mediaUpload.appendChild(mediaItem);
        });

        // Remove media functionality
        document.querySelectorAll('.remove-media').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.media-item').remove();
            });
        });
    </script>
{% endblock %}
